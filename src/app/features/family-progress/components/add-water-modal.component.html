<div class="modal-overlay" *ngIf="isOpen" (click)="onBackdropClick($event)">
  <div class="modal-content" role="dialog" aria-labelledby="modal-title" aria-modal="true">
    <!-- æ¨¡æ€æ¡†å¤´éƒ¨ -->
    <div class="modal-header">
      <h2 id="modal-title" class="modal-title">æ·»åŠ å–æ°´è®°å½•</h2>
      <button 
        class="close-btn" 
        type="button"
        (click)="close()"
        aria-label="å…³é—­æ¨¡æ€æ¡†">
        âœ•
      </button>
    </div>

    <!-- æˆå‘˜ä¿¡æ¯ -->
    <div *ngIf="member" class="member-info">
      <div 
        class="member-avatar"
        [style.background-color]="member.avatarBgColor">
        {{ member.avatar }}
      </div>
      <div class="member-details">
        <h3 class="member-name">{{ member.name }}</h3>
        <p class="member-progress">
          ä»Šæ—¥å·²å– {{ currentAmount }}ml / {{ member.dailyGoal }}ml
          <span class="percentage">({{ progressPercentage | number:'1.0-0' }}%)</span>
        </p>
        <p *ngIf="remainingAmount > 0" class="remaining-goal">
          è¿˜éœ€ {{ remainingAmount }}ml å®Œæˆç›®æ ‡
        </p>
        <p *ngIf="remainingAmount === 0" class="goal-completed">
          ğŸ‰ ä»Šæ—¥ç›®æ ‡å·²å®Œæˆï¼
        </p>
      </div>
    </div>

    <!-- å¿«æ·æ·»åŠ æŒ‰é’® -->
    <div class="quick-add-section" *ngIf="!showCustomInput">
      <h3 class="section-title">é€‰æ‹©æ°´é‡</h3>
      <div class="preset-buttons">
        <button 
          *ngFor="let amount of presetAmounts"
          class="preset-btn"
          type="button"
          (click)="onPresetAmountAdded(amount)"
          [attr.aria-label]="'æ·»åŠ  ' + amount + ' æ¯«å‡æ°´'">
          +{{ amount }}ml
        </button>
      </div>
      
      <button 
        class="custom-btn"
        type="button"
        (click)="showCustomAmountInput()">
        è‡ªå®šä¹‰æ°´é‡
      </button>
    </div>

    <!-- è‡ªå®šä¹‰è¾“å…¥ -->
    <div class="custom-input-section" *ngIf="showCustomInput">
      <h3 class="section-title">è¾“å…¥æ°´é‡</h3>
      <div class="input-group">
        <input 
          type="number"
          class="amount-input"
          [(ngModel)]="customAmount"
          placeholder="è¯·è¾“å…¥æ°´é‡"
          min="1"
          max="5000"
          #amountInput
          (keydown.enter)="onCustomAmountAdded()">
        <span class="input-suffix">ml</span>
      </div>
      
      <div class="custom-actions">
        <button 
          class="action-btn secondary"
          type="button"
          (click)="cancelCustomInput()">
          å–æ¶ˆ
        </button>
        <button 
          class="action-btn primary"
          type="button"
          [disabled]="!customAmount || customAmount <= 0"
          (click)="onCustomAmountAdded()">
          æ·»åŠ 
        </button>
      </div>
    </div>
  </div>
</div>

